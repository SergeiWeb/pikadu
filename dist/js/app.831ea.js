(()=>{var t={2027:(t,e,s)=>{"use strict";s(9752),s(3321),s(6776),s(8092)},9752:()=>{firebase.initializeApp({apiKey:"AIzaSyCW8XtwXN8iZ-fQQW4LckOGvyKKLwCd72o",authDomain:"pikadu-only.firebaseapp.com",databaseURL:"https://pikadu-only.firebaseio.com",projectId:"pikadu-only",storageBucket:"pikadu-only.appspot.com",messagingSenderId:"558065563938",appId:"1:558065563938:web:066096f618145fa5b80d7b"}),console.log(firebase);var t=/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/,e=document.querySelector(".login"),s=document.querySelector(".login-form"),n=document.querySelector(".login-form__email"),a=document.querySelector(".login-form__password"),o=document.querySelector(".login-form__signup"),r=document.querySelector(".login-form__forget"),i=document.querySelector(".user"),c=document.querySelector(".user-account__name"),l=document.querySelector(".user-actions"),u=document.querySelector(".user-account__avatar"),d=document.querySelector(".user-off"),v=document.querySelector(".user-edit"),p=document.querySelector(".user-editor"),f=document.querySelector(".editor-username"),m=document.querySelector(".editor-photo"),h=document.querySelector(".posts"),g=document.querySelector(".sidebar-buttons"),b=document.querySelector(".create"),y=document.querySelector(".create-form"),L=u.src,k={user:null,initUser:function(t){var e=this;firebase.auth().onAuthStateChanged((function(s){e.user=s||null,t&&t()}))},logIn:function(e,s,n){t.test(e)?firebase.auth().signInWithEmailAndPassword(e,s).catch((function(t){var e=t.code,s=t.message;"auth/wrong-password"===e?alert("Неверный пароль"):"auth/user-not-found"===e?alert("Пользователь не найден"):alert(s),console.error(t)})):alert("Email не валиден")},logOut:function(){firebase.auth().signOut()},signUp:function(e,s,n){var a=this;if(!t.test(e))return alert("Email не валиден");e.trim()&&s.trim()?firebase.auth().createUserWithEmailAndPassword(e,s).then((function(t){a.editUser(e.slice(0,e.indexOf("@")),null,n)})).catch((function(t){var e=t.code,s=t.message;"auth/week-password"===e?alert("Слабый пароль"):"auth/email-already-in-use"===e?alert("Этот Email уже используется"):alert(s),console.error(t)})):alert("Введите данные!")},editUser:function(t,e,s){var n=firebase.auth().currentUser;t&&(e?n.updateProfile({displayName:t,photoURL:e}).then(s):n.updateProfile({displayName:t}).then(s))},sendForget:function(t){firebase.auth().sendPasswordResetEmail(t).then((function(){return alert("Письмо отправлено вам на почту")})).catch((function(t){return console.error(t)}))}};r.addEventListener("click",(function(t){t.preventDefault(),k.sendForget(n.value),n.value=""}));var _={allPosts:[],addPost:function(t,e,s,n){var a=this,o=firebase.auth().currentUser;this.allPosts.unshift({id:"postID".concat((+new Date).toString(16),"-").concat(o.uid),title:t,text:e,tags:s.split(",").map((function(t){return t.trim()})),author:{displayName:k.user.displayName,photo:k.user.photoURL},date:(new Date).toLocaleString(),like:0,comments:0}),firebase.database().ref("post").set(this.allPosts).then((function(){return a.getPosts(n)})).then()},getPosts:function(t){var e=this;firebase.database().ref("post").on("value",(function(s){e.allPosts=s.val()||[],t()}))}},S=function(){var t=k.user;console.log("user: ",t),t?(e.style.display="none",i.style.display="",c.textContent=t.displayName,u.src=t.photoURL||L,g.classList.add("visible")):(e.style.display="",i.style.display="none",g.classList.remove("visible"),b.classList.remove("visible"),h.classList.add("visible"))},x=function(){var t="";_.allPosts.forEach((function(e){var s=e.title,n=e.text,a=e.tags,o=e.like,r=e.comments,i=e.author,c=e.date;t+='\n\t\t\t\t<section class="post">\n\t\t\t\t\t<div class="post-article">\n\t\t\t\t\t\t<h2 class="post-title">'.concat(s,'</h2>\n\t\t\t\t\t\t<p class="post-text">').concat(n,'</p>\n\t\t\t\t\t\t<ul class="post-tags">\n\t\t\t\t\t\t\t').concat(a.map((function(t){return'<li class="post-tags__tag"><a href="/'.concat(t,'">#').concat(t,"</a></li>")})).join(""),'\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="post-footer">\n\t\t\t\t\t\t<div class="post-actions">\n\t\t\t\t\t\t\t<button class="post-button likes">\n\t\t\t\t\t\t\t\t<svg class="icon">\n\t\t\t\t\t\t\t\t\t<use xlink:href="./assets/svg/icons.svg#like"></use>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t<span class="post-button__counter likes-counter">').concat(o,'</span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button class="post-button comments">\n\t\t\t\t\t\t\t\t<svg class="icon">\n\t\t\t\t\t\t\t\t\t<use xlink:href="./assets/svg/icons.svg#comment"></use>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t<span class="post-button__counter comments-counter">').concat(r,'</span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button class="post-button save">\n\t\t\t\t\t\t\t\t<svg class="icon">\n\t\t\t\t\t\t\t\t\t<use xlink:href="./assets/svg/icons.svg#save"></use>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button class="post-button share">\n\t\t\t\t\t\t\t\t<svg class="icon">\n\t\t\t\t\t\t\t\t\t<use xlink:href="./assets/svg/icons.svg#share"></use>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="post-author author">\n\t\t\t\t\t\t\t<div class="author-about">\n\t\t\t\t\t\t\t\t<span class="author-name"><a href="#">').concat(i.displayName,'</a></span>\n\t\t\t\t\t\t\t\t<span class="author-time">').concat(c,'</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<a href="#" class="author-photo">\n\t\t\t\t\t\t\t\t').concat(i.photo?'<img class="icon" src="'.concat(i.photo,'" />'):'<svg class="icon"><use xlink:href="./assets/svg/icons.svg#user"></use></svg>',"\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</section>\n\t\t\t")})),h.innerHTML=t,b.classList.remove("visible"),h.classList.add("visible")},q=function(){s.addEventListener("submit",(function(t){t.preventDefault();var e=n.value,o=a.value;k.logIn(e,o,S),s.reset()})),o.addEventListener("click",(function(t){t.preventDefault();var e=n.value,o=a.value;k.signUp(e,o,S),s.reset()})),d.addEventListener("click",(function(t){t.preventDefault(),k.logOut()})),v.addEventListener("click",(function(t){t.preventDefault(),p.classList.toggle("visible"),p.classList.contains("visible")?l.classList.add("hide"):l.classList.remove("hide"),f.value=k.user.displayName})),p.addEventListener("submit",(function(t){t.preventDefault(),k.editUser(f.value,m.value,S),p.classList.remove("visible"),l.classList.remove("hide")})),g.addEventListener("click",(function(t){t.preventDefault(),t.target.classList.contains("sidebar-buttons__btn--publish")&&(b.classList.add("visible"),h.classList.remove("visible"))})),y.addEventListener("submit",(function(t){t.preventDefault();var e=y.elements,s=e.title,n=e.text,a=e.tags;s.value.length<6?alert("Слишком короткий заголовок"):n.value.length<50?alert("Слишком короткий пост"):(_.addPost(s.value,n.value,a.value,x),b.classList.remove("visible"),y.reset())})),k.initUser(S),_.getPosts(x)};document.addEventListener("DOMContentLoaded",(function(){q()}))},3321:(t,e,s)=>{"use strict";t.exports=s.p+"img/user.jpg"},8092:(t,e,s)=>{"use strict";t.exports=s.p+"svg/icons.svg"},6776:(t,e,s)=>{"use strict";t.exports=s.p+"svg/user.svg"}},e={};function s(n){if(e[n])return e[n].exports;var a=e[n]={exports:{}};return t[n](a,a.exports,s),a.exports}s.m=t,s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},s.d=(t,e)=>{for(var n in e)s.o(e,n)&&!s.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.p="/",(()=>{var t={143:0},e=[[6981,216],[2027,216]],n=()=>{};function a(){for(var n,a=0;a<e.length;a++){for(var o=e[a],r=!0,i=1;i<o.length;i++){var c=o[i];0!==t[c]&&(r=!1)}r&&(e.splice(a--,1),n=s(s.s=o[0]))}return 0===e.length&&(s.x(),s.x=()=>{}),n}s.x=()=>{s.x=()=>{},r=r.slice();for(var t=0;t<r.length;t++)o(r[t]);return(n=a)()};var o=a=>{for(var o,r,[c,l,u,d]=a,v=0,p=[];v<c.length;v++)r=c[v],s.o(t,r)&&t[r]&&p.push(t[r][0]),t[r]=0;for(o in l)s.o(l,o)&&(s.m[o]=l[o]);for(u&&u(s),i(a);p.length;)p.shift()();return d&&e.push.apply(e,d),n()},r=self.webpackChunkwebpack_5=self.webpackChunkwebpack_5||[],i=r.push.bind(r);r.push=o})(),s.x()})();